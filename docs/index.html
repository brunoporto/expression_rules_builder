<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
  </head>
  <body>
    <h3>Expression Rules Builder</h3>
    <div id="expressions-container"></div>
    <hr />
    <div id="rules-container"></div>
    <hr />
    <button id="btnGetMyRules">Get Rules</button>
    <textarea
      id="myRules"
      style="display: block; width: 500px; height: 300px;"
    ></textarea>
    <script src="dist/expression-rules-builder.min.js" charset="utf-8"></script>
    <script type="text/javascript">
      var erb = ExpressionRulesBuilder({
        expressionsContainer: "#expressions-container",
        rulesContainer: "#rules-container",
        fields: [
          {
            name: "users",
            placeholder: "Users",
            type: "list",
            customClass: "my-select-class",
            values: [
              ["Bruno", "BRUNO"],
              ["JosÃ©", "JOSE"],
            ],
          },
          {
            name: "roles",
            placeholder: "Access Roles",
            customClass: "my-select-class",
            type: "list",
            values: [
              ["Admin", "ADMIN"],
              ["Client", "CLIENT"],
            ],
          },
          {
            name: "groups",
            placeholder: "Group",
            customClass: "my-select-class",
            type: "list",
            values: [
              ["Diamond", "DIAMOND"],
              ["Gold", "GOLD"],
              ["Silver", "SILVER"],
            ],
          },
          {
            name: "price",
            placeholder: "0,00",
            customClass: "my-input-class",
            type: "text",
          },
          {
            name: "percent",
            placeholder: "0",
            customClass: "my-input-class",
            type: "text",
          },
        ],
        expressions: [
          { name: "user", text: "the user {users}" },
          {
            name: "user_role",
            text: "the user {users} with role {roles}",
          },
          { name: "group", text: "the user of group {groups}" },
          { name: "price", text: "with price ${price}" },
          { name: "percent", text: "with {percent}% percent" },
        ],
        rules: [
          { expression: "user", fields: { users: "JOSE" } },
          {
            expression: "user_role",
            fields: { users: "BRUNO", roles: "ADMIN" },
          },
          { expression: "price", fields: { price: "50" } },
        ],
      });

      erb.beforeAddExpression(function (expressionName) {
        if (confirm("Are you sure?") == false) {
          console.log(`stopped by user!`);
          return false;
        }
      });
      erb.afterAddExpression(function (expressionName) {
        console.log(`Expression ${expressionName} added`);
      });
      erb.beforeRemoveRule(function (expressionName) {
        if (confirm("Are you sure?") == false) {
          console.log(`stopped by user!`);
          return false;
        }
      });
      erb.afterRemoveRule(function (expressionName) {
        console.log(`Rule ${expressionName} removed`);
      });

      document
        .getElementById("btnGetMyRules")
        .addEventListener("click", (ev) => {
          var values = erb.getRules();
          document.getElementById("myRules").value = JSON.stringify(
            values,
            undefined,
            4
          );
        });
    </script>

    <style>
      .erb-expression-item.selected {
        display: none;
      }
    </style>
  </body>
</html>
